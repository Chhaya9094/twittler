<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" type="text/css" href="style.css"/>
    <script src="jquery.js"></script>
    <script src="jquery.timeago.js" type="text/javascript"></script>
    <script src="data_generator.js"></script>
  </head>
  <body>
  <header id="header">
  <h1>Twittler <img src="img/leaf.png" id="icon" /></h1>

  </header>
  <div class="container">
  <div class="sidebar">
  <div id="user">
    <img src="img/user.jpg" id="user-pic" />
    <h3>Emily Coco<br/>@emilymcoco</h3>
    <span id="user-tweets">Tweets</span>
    <span id="following">Following: 4</span>
    <span>Followers: 0</span>
  </div>
  <div id="controls">
    <h3>Controls</h3>
    <form method="post" action="#">
      <label for="tweet-form">Tweet:</label>
      <input type="text-area" id="tweet-form" name="tweet-form">
    </form> 
  </div>
  </div>
  <div id="tweets">
  <h2>Tweets</h2>
  <button id="new-tweets" type="button"> Get New Tweets</button>
  <div id="tweet-container">
  </div>
  </div>
  </div>
    <script>

      $(document).ready(function(){
          var getTweets = function() {
            var subIndex = streams.home.length - 1;
            while (subIndex >=0) {
              var tweet = streams.home[subIndex];
              var $tweet = $('<div id="individual-tweet"><div id="handle"></div><div id="time"></div><p id="text"></p></div>');

              $tweet.find('#handle').text('@' + tweet.user)
              $tweet.find('#time').text(jQuery.timeago(tweet.created_at));
              $tweet.find('#text').text(tweet.message);
              $tweet.appendTo($('#tweet-container'));

              subIndex -= 1;
            }   
          }   

          var newTweets = function() {
              var checkInterval = function() {
                setInterval(function() {
                var timeIndex = streams.home.length - 1;
                var newTweetCount = subIndex;
                $('#new-tweets').text(newTweetCount + ' New Tweets');
                }, 3000);
              }
          } 

          getTweets(); 
          newTweets();
             

          $("#new-tweets").on('click', function() {
            $('#tweet-container').empty();
            getTweets();
            clearInterval(checkInterval);       
          });

        });

    </script>
  </body>
</html>
